
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Miragold - Laporan Harian Konten TikTok</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel to transpile JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- jsPDF for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

    <style>
        /* Custom scrollbar for a better look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        @import url('https://rsms.me/inter/inter.css');
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Note: This code is written using TypeScript syntax for clarity (e.g., type annotations).
        // Babel will transpile it to standard JavaScript that runs in the browser.
        // All necessary libraries are loaded via CDN in the <head> section.
        
        const { useState, useEffect } = React;
        const { jsPDF } = window.jspdf;

        // --- CONSTANTS ---
        const STAFF_LIST = [
            { id: 1, name: "MOHAMAD FIKRIE BIN ZAHARUN HISHAM", shortName: "FIKRIE" },
            { id: 2, name: "MUHAMMAD DANISH HISYAM BIN MOHD SAUFI", shortName: "HISYAM" },
            { id: 3, name: "NUR FARAH WAHEEDAH BINTI MOHD SALIMON", shortName: "WAHEEDAH" },
            { id: 4, name: "FATIN NUR SADIAH", shortName: "FATIN" },
        ];
        
        const JABATAN_LIST = ["VIDEOGRAPHER CUM EDITOR", "GRAPHIC DESIGN", "VIDEOGRAPHER CUM GRAPHIC", "CONTENT CREATOR"];
        
        const TIKTOK_ACCOUNTS = ["@miragoldkotamasai", "@kedaiemasmiragold", "@emasmiragold"];
        
        const CONTENT_TYPES = ["AWARENESS", "TESTIMONI", "PROMO", "BTS LIVE", "VIDEO PRODUCT", "BEG KUNING", "GAMBAR PRODUCT", "HARDSALE", "PROMO HARDSALE"];
        const LOCAL_STORAGE_KEY = 'tiktokReportDraft';

        // --- TYPE DEFINITIONS (for clarity) ---
        // interface Aktiviti { id: number; time: string; content: string; type: string; uploaded: boolean; }
        // interface Posting { id: number; time: string; content: string; type: string; uploaded: boolean; link: string; }
        // interface ReportData { staffName: string; jabatan: string; reportDate: string; tiktokAccount: string; aktivitiList: Aktiviti[]; postingList: Posting[]; notaList: string[]; }

        // --- ICON COMPONENTS ---
        const PlusIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fillRule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clipRule="evenodd" />
            </svg>
        );

        const TrashIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clipRule="evenodd" />
            </svg>
        );
        
        // --- HELPER FUNCTIONS ---
        const formatTime12Hour = (time24) => {
            if (!time24) return '';
            const [hours, minutes] = time24.split(':');
            let h = parseInt(hours, 10);
            const ampm = h >= 12 ? 'PM' : 'AM';
            h = h % 12;
            h = h ? h : 12; // The hour '0' should be '12'
            const paddedMinutes = String(minutes).padStart(2, '0');
            return `${h}:${paddedMinutes} ${ampm}`;
        };

        // --- PDF GENERATION LOGIC ---
        const generatePdf = (reportData) => {
            const doc = new jsPDF();
            const pageHeight = doc.internal.pageSize.height || doc.internal.pageSize.getHeight();
            const pageWidth = doc.internal.pageSize.width || doc.internal.pageSize.getWidth();
            let finalY = 0;
            
            // --- PDF Header ---
            doc.setFontSize(20);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(40, 40, 40);
            doc.text("Laporan Harian Konten TikTok", pageWidth / 2, 25, { align: 'center' });
            
            // Report Info Section
            const formattedDateForDisplay = new Date(reportData.reportDate + 'T00:00:00').toLocaleDateString('en-GB', {
                day: 'numeric', month: 'long', year: 'numeric'
            }).toUpperCase();

            const reportInfoBody = [
                ['Nama Staf', reportData.staffName],
                ['Jawatan', reportData.jabatan],
                ['Akaun TikTok', reportData.tiktokAccount],
                ['Tarikh Laporan', formattedDateForDisplay],
            ];

            doc.autoTable({
                startY: 35,
                body: reportInfoBody,
                theme: 'grid', // Use 'grid' theme for a boxed look
                styles: {
                    font: 'helvetica',
                    fontSize: 9, // Minimalist font size
                    cellPadding: 2,
                    lineColor: [220, 220, 220], // Light grey for subtle borders
                    lineWidth: 0.1,
                },
                columnStyles: {
                    0: { fontStyle: 'bold', cellWidth: 35 }, // Adjusted width
                    1: { cellWidth: 'auto' },
                },
                tableWidth: 'wrap',
                margin: { left: 14 } // Align block to the left
            });
            
            finalY = doc.autoTable.previous.finalY;

            // Aktiviti Konten Table
            doc.setFontSize(12);
            doc.setFont("helvetica", "bold");
            doc.text("Aktiviti Konten", 14, finalY + 12);

            if (reportData.aktivitiList.length > 0) {
                 doc.autoTable({
                    startY: finalY + 15,
                    head: [['MASA', 'KANDUNGAN', 'JENIS', 'STATUS UPLOAD TELEGRAM']],
                    body: reportData.aktivitiList.map(item => [formatTime12Hour(item.time), item.content, item.type, item.uploaded ? '✓ UPLOAD' : '✗ PENDING']),
                    theme: 'striped',
                    headStyles: {
                        fillColor: [8, 145, 178], // Cyan-600
                        textColor: [255, 255, 255],
                        fontStyle: 'bold',
                        halign: 'center',
                        fontSize: 10,
                    },
                    styles: { fontSize: 9 },
                    columnStyles: {
                        0: { cellWidth: 30, halign: 'center' },
                        1: { cellWidth: 'auto', halign: 'left' },
                        2: { cellWidth: 40, halign: 'center' },
                        3: { cellWidth: 45, halign: 'center' },
                    },
                    didDrawCell: (data) => {
                        if (data.section === 'body' && data.column.index === 3) {
                            doc.setFontSize(10);
                            if (data.cell.raw === '✓ UPLOAD') {
                                doc.setTextColor(22, 163, 74); // green-600
                            } else {
                                doc.setTextColor(220, 38, 38); // red-600
                            }
                            doc.text(data.cell.raw, data.cell.x + data.cell.width / 2, data.cell.y + data.cell.height / 2 + 3, { align: 'center' });
                        }
                    },
                    didParseCell: function (data) {
                        if (data.section === 'body' && data.column.index === 3) {
                             data.cell.text = ['']; // Prevent autotable from drawing default text
                        }
                    }
                });
            } else {
                 doc.setFont("helvetica", "normal");
                 doc.setFontSize(10);
                 doc.text("Tiada Aktiviti Konten direkodkan.", 14, finalY + 20);
                 doc.autoTable({ startY: finalY + 25 }); // To get finalY position
            }

            finalY = doc.autoTable.previous.finalY;

            // Posting TikTok Table
            doc.setFontSize(12);
            doc.setFont("helvetica", "bold");
            doc.text(`Posting TikTok ${reportData.tiktokAccount}`, 14, finalY + 12);

            doc.autoTable({
                startY: finalY + 15,
                head: [['MASA', 'KANDUNGAN', 'JENIS', 'STATUS UPLOAD TIKTOK', 'LINK']],
                body: reportData.postingList.map(item => [formatTime12Hour(item.time), item.content, item.type, item.uploaded ? '✓ UPLOAD' : '✗ PENDING', item.link]),
                theme: 'striped',
                headStyles: {
                    fillColor: [8, 145, 178], // Cyan-600
                    textColor: [255, 255, 255],
                    fontStyle: 'bold',
                    halign: 'center',
                    fontSize: 10,
                },
                styles: { fontSize: 9 },
                columnStyles: {
                    0: { cellWidth: 30, halign: 'center' },
                    1: { cellWidth: 'auto', halign: 'left' },
                    2: { cellWidth: 35, halign: 'center' },
                    3: { cellWidth: 40, halign: 'center' },
                    4: { cellWidth: 15, halign: 'center' },
                },
                didDrawCell: (data) => {
                    if (data.section === 'body' && data.column.index === 3) {
                         doc.setFontSize(10);
                        if (data.cell.raw === '✓ UPLOAD') {
                            doc.setTextColor(22, 163, 74); // green-600
                        } else {
                            doc.setTextColor(220, 38, 38); // red-600
                        }
                        doc.text(data.cell.raw, data.cell.x + data.cell.width / 2, data.cell.y + data.cell.height / 2 + 3, { align: 'center' });
                    }
                    if (data.section === 'body' && data.column.index === 4 && data.cell.raw) {
                        doc.setFontSize(9);
                        doc.setTextColor(14, 116, 144); // Cyan-700 link color
                        doc.textWithLink('Link', data.cell.x + data.cell.width / 2, data.cell.y + data.cell.height / 2 + 3, { url: data.cell.raw, align: 'center' });
                    }
                },
                didParseCell: function (data) {
                    if (data.section === 'body' && (data.column.index === 3 || (data.column.index === 4 && data.cell.raw))) {
                        data.cell.text = ['']; // Prevent autotable from drawing status and link text
                    }
                }
            });

            finalY = doc.autoTable.previous.finalY;

            // Nota
            if (reportData.notaList.length > 0) {
                doc.setFontSize(12);
                doc.setFont("helvetica", "bold");
                doc.text("NOTA TAMBAHAN", 14, finalY + 20);
                
                doc.setFont("helvetica", "normal");
                doc.setFontSize(10);
                let notaY = finalY + 28;
                reportData.notaList.forEach(nota => {
                    if(notaY > pageHeight - 25) { // Add margin for footer
                        doc.addPage();
                        notaY = 20;
                    }
                    const splitNota = doc.splitTextToSize(`• ${nota}`, pageWidth - 30);
                    doc.text(splitNota, 16, notaY);
                    notaY += (splitNota.length * 5);
                });
            }

            // --- PDF Footer (Page Numbers) ---
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(9);
                doc.setTextColor(150);
                doc.text(`Page ${i} of ${pageCount}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
            }

            // Save file
            const dateObj = new Date(reportData.reportDate + 'T00:00:00');
            const month = String(dateObj.getMonth() + 1).padStart(2, '0');
            const day = String(dateObj.getDate()).padStart(2, '0');
            const selectedStaff = STAFF_LIST.find(s => s.name === reportData.staffName);
            const shortName = selectedStaff ? selectedStaff.shortName.toUpperCase() : 'STAFF';
            const fileName = `${month}${day} REPORT ${shortName}.pdf`;
            doc.save(fileName);
        };


        // --- MAIN APP COMPONENT ---
        const App = () => {
            const today = new Date().toISOString().split('T')[0];

            // --- STATE MANAGEMENT ---
            const [reportData, setReportData] = useState({
                staffName: STAFF_LIST[0].name,
                jabatan: JABATAN_LIST[0],
                reportDate: today,
                tiktokAccount: TIKTOK_ACCOUNTS[0],
                aktivitiList: [],
                postingList: [],
                notaList: [],
            });

            const [newAktiviti, setNewAktiviti] = useState({ time: '', content: '', type: '', uploaded: true });
            const [newPosting, setNewPosting] = useState({ time: '', content: '', type: '', uploaded: true, link: '' });
            const [newNota, setNewNota] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [draftExists, setDraftExists] = useState(false);

            // --- EFFECTS for AUTO-SAVE and DRAFT CHECK ---

            // Check for a saved draft when the component mounts
            useEffect(() => {
                const savedDraft = localStorage.getItem(LOCAL_STORAGE_KEY);
                if (savedDraft) {
                    setDraftExists(true);
                }
            }, []);

            // Auto-save report data to localStorage whenever it changes (with debounce)
            useEffect(() => {
                const handler = setTimeout(() => {
                    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(reportData));
                    setDraftExists(true);
                }, 1000); // Debounce time: 1 second

                return () => {
                    clearTimeout(handler);
                };
            }, [reportData]);


            // --- HANDLER FUNCTIONS ---

            const handleLoadDraft = () => {
                const savedDraft = localStorage.getItem(LOCAL_STORAGE_KEY);
                if (savedDraft) {
                    if (window.confirm('Anda pasti mahu memuatkan draf terakhir? Ini akan menulis ganti sebarang perubahan semasa.')) {
                        setReportData(JSON.parse(savedDraft));
                        alert('Draf berjaya dimuatkan!');
                    }
                } else {
                    alert('Tiada draf yang disimpan dijumpai.');
                }
            };

            const handleClearDraft = () => {
                if (window.confirm('Anda pasti mahu memadam draf yang disimpan? Tindakan ini tidak boleh dibuat asal.')) {
                    localStorage.removeItem(LOCAL_STORAGE_KEY);
                    setDraftExists(false);
                    alert('Draf dipadam.');
                }
            };

            const handleStaffChange = (e) => {
                setReportData(prev => ({ ...prev, staffName: e.target.value }));
            };
            
            const handleJabatanChange = (e) => {
                setReportData(prev => ({ ...prev, jabatan: e.target.value }));
            };

            const handleAccountChange = (e) => {
                setReportData(prev => ({ ...prev, tiktokAccount: e.target.value }));
            };
            
            const handleAddAktiviti = (e) => {
                e.preventDefault();
                if (!newAktiviti.time || !newAktiviti.content || !newAktiviti.type) return;
                setReportData(prev => ({
                    ...prev,
                    aktivitiList: [...prev.aktivitiList, { ...newAktiviti, id: Date.now() }]
                }));
                setNewAktiviti({ time: '', content: '', type: '', uploaded: true });
            };

            const handleDeleteAktiviti = (id) => {
                setReportData(prev => ({
                    ...prev,
                    aktivitiList: prev.aktivitiList.filter(item => item.id !== id)
                }));
            };

            const handleToggleAktivitiStatus = (id) => {
                setReportData(prev => ({
                    ...prev,
                    aktivitiList: prev.aktivitiList.map(item =>
                        item.id === id ? { ...item, uploaded: !item.uploaded } : item
                    )
                }));
            };
            
            const handleAddPosting = (e) => {
                e.preventDefault();
                if (!newPosting.time || !newPosting.content || !newPosting.type) return;
                setReportData(prev => ({
                    ...prev,
                    postingList: [...prev.postingList, { ...newPosting, id: Date.now() }]
                }));
                setNewPosting({ time: '', content: '', type: '', uploaded: true, link: '' });
            };

            const handleDeletePosting = (id) => {
                setReportData(prev => ({
                    ...prev,
                    postingList: prev.postingList.filter(item => item.id !== id)
                }));
            };
            
            const handleTogglePostingStatus = (id) => {
                setReportData(prev => ({
                    ...prev,
                    postingList: prev.postingList.map(item =>
                        item.id === id ? { ...item, uploaded: !item.uploaded } : item
                    )
                }));
            };
            
            const handleAddNota = (e) => {
                e.preventDefault();
                if (!newNota.trim()) return;
                setReportData(prev => ({
                    ...prev,
                    notaList: [...prev.notaList, newNota]
                }));
                setNewNota('');
            };

            const handleDeleteNota = (index) => {
                 setReportData(prev => ({
                    ...prev,
                    notaList: prev.notaList.filter((_, i) => i !== index)
                }));
            };

            const handleGeneratePdf = () => {
                setIsLoading(true);
                // Use a timeout to allow the UI to update to the loading state
                setTimeout(() => {
                    try {
                        generatePdf(reportData);
                    } catch (error) {
                        console.error("Failed to generate PDF:", error);
                        alert("An error occurred while generating the PDF. Please check the console for details.");
                    } finally {
                        setIsLoading(false);
                    }
                }, 100);
            };

            // --- JSX STRUCTURE ---
            return (
                <div className="min-h-screen bg-cyan-50 p-4 sm:p-6 lg:p-8">
                    <div className="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 sm:p-8">
                        
                        {/* Header */}
                        <div className="text-center mb-8 relative">
                            <h1 className="text-2xl font-bold text-gray-800 tracking-tight">Laporan Harian Konten TikTok</h1>
                            <p className="text-sm text-gray-500 mt-1">credit by TEAM MEDIA</p>
                            {draftExists && (
                                <div className="absolute top-0 right-0 flex items-center gap-2">
                                     <button onClick={handleLoadDraft} className="bg-blue-100 text-blue-700 text-xs font-semibold px-3 py-1.5 rounded-full hover:bg-blue-200 transition">
                                         Muat Draf Terakhir
                                     </button>
                                     <button onClick={handleClearDraft} title="Padam Draf" className="text-gray-400 hover:text-red-500">
                                         <TrashIcon />
                                     </button>
                                </div>
                            )}
                        </div>
                        
                        {/* Staff & Date Section */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 border-t border-gray-200 pt-8">
                            <div>
                                <label htmlFor="staff" className="block text-sm font-medium text-gray-700 mb-1">Nama Staf</label>
                                <select id="staff" value={reportData.staffName} onChange={handleStaffChange} className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-500 focus:border-cyan-500">
                                    {STAFF_LIST.map(staff => <option key={staff.id} value={staff.name}>{staff.name}</option>)}
                                </select>
                            </div>
                            <div>
                                <label htmlFor="jabatan" className="block text-sm font-medium text-gray-700 mb-1">Jawatan</label>
                                <select id="jabatan" value={reportData.jabatan} onChange={handleJabatanChange} className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-500 focus:border-cyan-500">
                                    {JABATAN_LIST.map(jabatan => <option key={jabatan} value={jabatan}>{jabatan}</option>)}
                                </select>
                            </div>
                            <div>
                                <label htmlFor="tiktok-account" className="block text-sm font-medium text-gray-700 mb-1">Akaun TikTok</label>
                                <select id="tiktok-account" value={reportData.tiktokAccount} onChange={handleAccountChange} className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-500 focus:border-cyan-500">
                                    {TIKTOK_ACCOUNTS.map(acc => <option key={acc} value={acc}>{acc}</option>)}
                                </select>
                            </div>
                            <div>
                                <label htmlFor="date" className="block text-sm font-medium text-gray-700 mb-1">Tarikh Laporan</label>
                                <input type="date" id="date" value={reportData.reportDate} onChange={e => setReportData(prev => ({...prev, reportDate: e.target.value}))} className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-500 focus:border-cyan-500"/>
                            </div>
                        </div>
                        
                        {/* Aktiviti Konten Section */}
                        <Section title="Aktiviti Konten">
                            <form onSubmit={handleAddAktiviti} className="grid grid-cols-1 sm:grid-cols-4 gap-4 items-end mb-4 p-4 bg-gray-50 rounded-lg">
                                <Input label="Masa" type="time" value={newAktiviti.time} onChange={e => setNewAktiviti({...newAktiviti, time: e.target.value})} required/>
                                <Input label="Kandungan" value={newAktiviti.content} onChange={e => setNewAktiviti({...newAktiviti, content: e.target.value})} required className="sm:col-span-2"/>
                                <Select label="Jenis" value={newAktiviti.type} onChange={e => setNewAktiviti({...newAktiviti, type: e.target.value})} options={CONTENT_TYPES} required/>
                                <button type="submit" className="sm:col-start-4 flex justify-center items-center gap-2 w-full bg-cyan-600 text-white p-2 rounded-md hover:bg-cyan-700 transition duration-200">
                                    <PlusIcon /> Add Aktiviti
                                </button>
                            </form>
                            <AktivitiTable data={reportData.aktivitiList} onDelete={handleDeleteAktiviti} onToggleStatus={handleToggleAktivitiStatus} />
                        </Section>
                        
                        {/* Posting TikTok Section */}
                        <Section title={`Posting TikTok ${reportData.tiktokAccount}`}>
                             <form onSubmit={handleAddPosting} className="grid grid-cols-1 sm:grid-cols-6 gap-4 items-end mb-4 p-4 bg-gray-50 rounded-lg">
                                <Input label="Masa" type="time" value={newPosting.time} onChange={e => setNewPosting({...newPosting, time: e.target.value})} required/>
                                <Input label="Kandungan" value={newPosting.content} onChange={e => setNewPosting({...newPosting, content: e.target.value})} required className="sm:col-span-2"/>
                                <Select label="Jenis" value={newPosting.type} onChange={e => setNewPosting({...newPosting, type: e.target.value})} options={CONTENT_TYPES} required/>
                                <Input label="Link" value={newPosting.link} onChange={e => setNewPosting({...newPosting, link: e.target.value})} placeholder="https://tiktok.com/..."/>
                                <button type="submit" className="sm:col-start-6 flex justify-center items-center gap-2 w-full bg-cyan-600 text-white p-2 rounded-md hover:bg-cyan-700 transition duration-200">
                                    <PlusIcon /> Add Posting
                                </button>
                            </form>
                            <PostingTable data={reportData.postingList} onDelete={handleDeletePosting} onToggleStatus={handleTogglePostingStatus} />
                        </Section>

                        {/* Nota Section */}
                        <Section title="Nota Tambahan">
                            <form onSubmit={handleAddNota} className="flex gap-4 items-center mb-4 p-4 bg-gray-50 rounded-lg">
                                <Input label="Nota" value={newNota} onChange={e => setNewNota(e.target.value)} className="flex-grow" noLabel/>
                                <button type="submit" className="flex-shrink-0 bg-cyan-600 text-white p-2 rounded-md hover:bg-cyan-700 transition duration-200">
                                    <PlusIcon />
                                </button>
                            </form>
                             <ul className="space-y-2">
                                {reportData.notaList.map((nota, index) => (
                                    <li key={index} className="flex items-center justify-between bg-white p-2 border rounded-md">
                                        <span className="text-gray-700 flex-grow pr-4">{nota}</span>
                                        <button onClick={() => handleDeleteNota(index)} className="text-red-500 hover:text-red-700 flex-shrink-0"><TrashIcon /></button>
                                    </li>
                                ))}
                            </ul>
                        </Section>

                        {/* Generate PDF Button */}
                        <div className="mt-10 text-center">
                            <button onClick={handleGeneratePdf} disabled={isLoading} className="w-full md:w-1/2 bg-cyan-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:bg-cyan-600 transition duration-300 transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:scale-100">
                                {isLoading ? 'Menjana PDF...' : 'Generate PDF Report'}
                            </button>
                        </div>

                    </div>
                </div>
            );
        };

        // --- HELPER & UI COMPONENTS ---

        const Section = ({ title, children }) => (
            <div className="mb-8">
                <h3 className="text-lg font-bold text-gray-800 border-b-2 border-cyan-400 pb-2 mb-4">{title}</h3>
                {children}
            </div>
        );

        const Input = ({ label, type = 'text', value, onChange, required=false, className='', placeholder='', noLabel=false }) => (
            <div className={className}>
                {!noLabel && <label className="block text-sm font-medium text-gray-700 mb-1">{label}</label>}
                <input
                    type={type}
                    value={value}
                    onChange={onChange}
                    required={required}
                    placeholder={placeholder}
                    className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-500 focus:border-cyan-500"
                />
            </div>
        );
        
        const Select = ({ label, value, onChange, options, required=false, className='' }) => (
            <div className={className}>
                <label className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
                <select
                    value={value}
                    onChange={onChange}
                    required={required}
                    className="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-500 focus:border-cyan-500"
                >
                    <option value="" disabled>Pilih satu...</option>
                    {options.map(option => <option key={option} value={option}>{option}</option>)}
                </select>
            </div>
        );
        
        const AktivitiTable = ({ data, onDelete, onToggleStatus }) => (
            <div className="overflow-x-auto">
                <table className="min-w-full divide-y divide-gray-200">
                    <thead className="bg-gray-50">
                        <tr>
                            <th className="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Masa</th>
                            <th className="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kandungan</th>
                            <th className="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Jenis</th>
                            <th className="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Status Upload</th>
                            <th className="px-4 py-2"></th>
                        </tr>
                    </thead>
                    <tbody className="bg-white divide-y divide-gray-200">
                        {data.length === 0 ? (
                            <tr><td colSpan="5" className="text-center py-4 text-gray-500">Tiada aktiviti ditambah.</td></tr>
                        ) : data.map(item => (
                            <tr key={item.id}>
                                <td className="px-4 py-2 whitespace-nowrap">{formatTime12Hour(item.time)}</td>
                                <td className="px-4 py-2">{item.content}</td>
                                <td className="px-4 py-2 whitespace-nowrap">{item.type}</td>
                                <td className="px-4 py-2 text-center">
                                    <button onClick={() => onToggleStatus(item.id)} className={`px-3 py-1 text-sm font-semibold rounded-full w-24 text-center transition-colors ${item.uploaded ? 'bg-green-100 text-green-800 hover:bg-green-200' : 'bg-red-100 text-red-800 hover:bg-red-200'}`}>
                                        {item.uploaded ? '✓ UPLOAD' : '✗ PENDING'}
                                    </button>
                                </td>
                                <td className="px-4 py-2 text-right">
                                    <button onClick={() => onDelete(item.id)} className="text-gray-400 hover:text-red-600"><TrashIcon /></button>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>
        );

        const PostingTable = ({ data, onDelete, onToggleStatus }) => (
            <div className="overflow-x-auto">
                <table className="min-w-full divide-y divide-gray-200">
                    <thead className="bg-gray-50">
                        <tr>
                            <th className="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Masa</th>
                            <th className="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kandungan</th>
                            <th className="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Jenis</th>
                            <th className="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Status Upload</th>
                            <th className="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Link</th>
                            <th className="px-4 py-2"></th>
                        </tr>
                    </thead>
                     <tbody className="bg-white divide-y divide-gray-200">
                        {data.length === 0 ? (
                             <tr><td colSpan="6" className="text-center py-4 text-gray-500">Tiada posting ditambah.</td></tr>
                        ) : data.map(item => (
                            <tr key={item.id}>
                                <td className="px-4 py-2 whitespace-nowrap">{formatTime12Hour(item.time)}</td>
                                <td className="px-4 py-2">{item.content}</td>
                                <td className="px-4 py-2 whitespace-nowrap">{item.type}</td>
                                <td className="px-4 py-2 text-center">
                                    <button onClick={() => onToggleStatus(item.id)} className={`px-3 py-1 text-sm font-semibold rounded-full w-24 text-center transition-colors ${item.uploaded ? 'bg-green-100 text-green-800 hover:bg-green-200' : 'bg-red-100 text-red-800 hover:bg-red-200'}`}>
                                        {item.uploaded ? '✓ UPLOAD' : '✗ PENDING'}
                                    </button>
                                </td>
                                <td className="px-4 py-2">
                                    {item.link ? (
                                        <a href={item.link} target="_blank" rel="noopener noreferrer" className="text-cyan-600 hover:underline">
                                            Lihat Link
                                        </a>
                                    ) : (
                                        <span className="text-gray-400">-</span>
                                    )}
                                </td>
                                <td className="px-4 py-2 text-right">
                                    <button onClick={() => onDelete(item.id)} className="text-gray-400 hover:text-red-600"><TrashIcon /></button>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>
        );

        // --- RENDER APP ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>